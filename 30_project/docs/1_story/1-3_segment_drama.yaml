meta:
  role: segment_drama
  version: 1.0
  status: draft

schema:
  type: object
  required: [meta, content]
  properties:
    meta:
      type: object
      required: [role, version]
      properties:
        role: {type: string}
        version: {type: number}
        status: {type: string}
    content:
      type: object
      required: [segments]
      properties:
        segments:
          type: array
          items:
            type: object
            required: [segment, dramatic_function, emotional_arc, conflict, notes]
            properties:
              segment: {type: string}
              dramatic_function:
                type: string
                enum: [introduce, escalate, reveal, reverse, resolve]
              emotional_arc:
                type: object
                required: [start, peak, end]
                properties:
                  start: {type: string}
                  peak: {type: string}
                  end: {type: string}
              conflict:
                type: object
                required: [wants, obstacle, escalation]
                properties:
                  wants: {type: string}
                  obstacle: {type: string}
                  escalation: {type: string}
              notes: {type: string}

fields:
  - path: meta.role
    purpose: 文档角色标识
    type: string
    required: true
    default: segment_drama
  - path: meta.version
    purpose: 模板版本
    type: number
    required: true
    default: 1.0
  - path: meta.status
    purpose: 文档状态
    type: string
    required: false
    default: draft
  - path: content.segments[].segment
    purpose: 段落编号
    type: string
    required: true
    default: "segment001"
  - path: content.segments[].dramatic_function
    purpose: 段落戏剧功能
    type: string
    required: true
    default: introduce
  - path: content.segments[].emotional_arc
    purpose: 情绪起伏描述
    type: object
    required: true
    default: {start: "", peak: "", end: ""}
  - path: content.segments[].conflict
    purpose: 冲突结构
    type: object
    required: true
    default: {wants: "", obstacle: "", escalation: ""}
  - path: content.segments[].notes
    purpose: 戏剧性备注
    type: string
    required: true
    default: ""

content:
  segments:
    - segment: "segment001"
      dramatic_function: "introduce"
      emotional_arc: {start: "", peak: "", end: ""}
      conflict: {wants: "", obstacle: "", escalation: ""}
      notes: ""

example:
  meta: {role: segment_drama, version: 1.0, status: draft}
  content:
    segments:
      - segment: "segment001"
        dramatic_function: "introduce"
        emotional_arc: {start: "稳定", peak: "波动", end: "稳定"}
        conflict: {wants: "目标确立", obstacle: "限制出现", escalation: "压力增加"}
        notes: "说明冲突如何推动节拍"
